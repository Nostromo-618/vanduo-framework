/**
 * Vanduo Framework - Documentation Search Component
 * Search functionality for documentation pages
 */

:root {
  /* Search Input */
  --doc-search-input-bg: var(--input-bg);
  --doc-search-input-border: var(--input-border-color);
  --doc-search-input-focus-border: var(--color-primary);
  --doc-search-input-radius: var(--input-border-radius);
  --doc-search-input-padding-y: 0.5rem;
  --doc-search-input-padding-x: 0.75rem;
  --doc-search-input-padding-left: 30px;
  
  /* Search Results */
  --doc-search-results-bg: var(--card-bg, var(--bg-primary));
  --doc-search-results-border: var(--border-color);
  --doc-search-results-shadow: var(--shadow-lg);
  --doc-search-results-max-height: 400px;
  --doc-search-results-radius: var(--input-border-radius);
  
  /* Result Items */
  --doc-search-result-padding: 0.75rem 1rem;
  --doc-search-result-hover-bg: var(--color-primary-alpha-10, rgba(34, 184, 207, 0.1));
  --doc-search-result-active-bg: var(--color-primary-alpha-20, rgba(34, 184, 207, 0.2));
  
  /* Highlight */
  --doc-search-highlight-bg: var(--color-warning-alpha-30, rgba(250, 176, 5, 0.3));
  --doc-search-highlight-color: inherit;
  
  /* Shortcut Badge */
  --doc-search-shortcut-bg: var(--bg-secondary);
  --doc-search-shortcut-border: var(--border-color);
  --doc-search-shortcut-color: var(--text-muted);
}

/* Dark Theme Overrides */
[data-theme="dark"] {
  --doc-search-results-bg: var(--bg-secondary);
  --doc-search-shortcut-bg: var(--bg-tertiary);
}

@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) {
    --doc-search-results-bg: var(--bg-secondary);
    --doc-search-shortcut-bg: var(--bg-tertiary);
  }
}

/* ============================================
   Search Container
   ============================================ */

.vd-doc-search {
  position: relative;
  margin-bottom: 1rem;
}

/* ============================================
   Search Input Wrapper
   ============================================ */

.vd-doc-search-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
}

/* Search Icon */
.vd-doc-search-icon {
  position: absolute;
  left: 0.625rem;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-muted);
  font-size: 1.125rem;
  pointer-events: none;
  z-index: 1;
  transition: color 0.15s ease;
}

.vd-doc-search-input:focus ~ .vd-doc-search-icon,
.vd-doc-search-input-wrapper:focus-within .vd-doc-search-icon {
  color: var(--color-primary);
}

/* Search Input - input.vd-doc-search-input matches forms.css specificity so padding overrides base input[type="search"] */
input.vd-doc-search-input {
  width: 100%;
  padding: var(--input-padding-y) var(--input-padding-x);
  padding-left: var(--doc-search-input-padding-left);
  font-family: var(--font-family-sans);
  font-size: var(--font-size-sm);
  line-height: var(--line-height-normal);
  color: var(--text-primary);
  background-color: var(--doc-search-input-bg);
  border: 1px solid var(--doc-search-input-border);
  border-radius: var(--doc-search-input-radius);
  transition: border-color 0.15s ease, box-shadow 0.15s ease;
  appearance: none;
}

.vd-doc-search-input::placeholder {
  color: var(--text-muted);
  opacity: 1;
}

.vd-doc-search-input:focus {
  outline: none;
  border-color: var(--doc-search-input-focus-border);
  box-shadow: 0 0 0 3px var(--color-primary-alpha-20, rgba(34, 184, 207, 0.2));
}

/* Clear the default search cancel button */
.vd-doc-search-input::-webkit-search-cancel-button {
  -webkit-appearance: none;
  appearance: none;
}

/* Keyboard Shortcut Badge */
.vd-doc-search-shortcut {
  position: absolute;
  right: var(--doc-search-input-padding-x);
  top: 50%;
  transform: translateY(-50%);
  display: inline-flex;
  align-items: center;
  gap: 0.125rem;
  padding: 0.125rem 0.375rem;
  font-family: var(--font-family-sans);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
  color: var(--doc-search-shortcut-color);
  background-color: var(--doc-search-shortcut-bg);
  border: 1px solid var(--doc-search-shortcut-border);
  border-radius: 4px;
  pointer-events: none;
  user-select: none;
}

/* Hide shortcut when input has value */
.vd-doc-search-input:not(:placeholder-shown) ~ .vd-doc-search-shortcut {
  display: none;
}

/* ============================================
   Search Results Dropdown
   ============================================ */

.vd-doc-search-results {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  z-index: 1000;
  display: none;
  margin-top: 0.5rem;
  background-color: var(--doc-search-results-bg);
  border: 1px solid var(--doc-search-results-border);
  border-radius: var(--doc-search-results-radius);
  box-shadow: var(--doc-search-results-shadow);
  max-height: var(--doc-search-results-max-height);
  overflow-y: auto;
  overflow-x: hidden;
}

.vd-doc-search-results.is-open {
  display: block;
}

/* Results List */
.vd-doc-search-results-list {
  list-style: none;
  margin: 0;
  padding: 0.5rem 0;
}

/* ============================================
   Search Result Item
   ============================================ */

.vd-doc-search-result {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: var(--doc-search-result-padding);
  cursor: pointer;
  transition: background-color 0.1s ease;
  text-decoration: none;
  color: inherit;
}

.vd-doc-search-result:hover {
  background-color: var(--doc-search-result-hover-bg);
}

.vd-doc-search-result.is-active,
.vd-doc-search-result:focus {
  background-color: var(--doc-search-result-active-bg);
  outline: none;
}

/* Result Icon */
.vd-doc-search-result-icon {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 2rem;
  height: 2rem;
  background-color: var(--color-primary-alpha-10, rgba(34, 184, 207, 0.1));
  border-radius: 6px;
  color: var(--color-primary);
  font-size: 1rem;
}

/* Result Content */
.vd-doc-search-result-content {
  flex: 1;
  min-width: 0;
}

.vd-doc-search-result-title {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--text-primary);
  line-height: 1.4;
  margin-bottom: 0.125rem;
}

.vd-doc-search-result-category {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  margin-bottom: 0.25rem;
}

.vd-doc-search-result-excerpt {
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  line-height: 1.4;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Highlight matched text */
.vd-doc-search-result mark,
.vd-doc-search-highlight {
  background-color: var(--doc-search-highlight-bg);
  color: var(--doc-search-highlight-color);
  padding: 0 0.125rem;
  border-radius: 2px;
}

/* ============================================
   Empty State
   ============================================ */

.vd-doc-search-empty {
  padding: 2rem 1rem;
  text-align: center;
  color: var(--text-muted);
}

.vd-doc-search-empty-icon {
  font-size: 2.5rem;
  margin-bottom: 0.75rem;
  opacity: 0.5;
}

.vd-doc-search-empty-title {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--text-primary);
  margin-bottom: 0.25rem;
}

.vd-doc-search-empty-text {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

/* ============================================
   Loading State
   ============================================ */

.vd-doc-search-loading {
  padding: 1.5rem 1rem;
  text-align: center;
  color: var(--text-muted);
}

.vd-doc-search-loading-spinner {
  display: inline-block;
  width: 1.5rem;
  height: 1.5rem;
  border: 2px solid var(--border-color);
  border-top-color: var(--color-primary);
  border-radius: 50%;
  animation: doc-search-spin 0.6s linear infinite;
}

@keyframes doc-search-spin {
  to {
    transform: rotate(360deg);
  }
}

/* ============================================
   Footer Hint
   ============================================ */

.vd-doc-search-footer {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  padding: 0.5rem 1rem;
  border-top: 1px solid var(--border-color);
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

.vd-doc-search-footer kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 1.25rem;
  height: 1.25rem;
  padding: 0 0.25rem;
  font-family: var(--font-family-sans);
  font-size: 0.625rem;
  font-weight: var(--font-weight-medium);
  background-color: var(--doc-search-shortcut-bg);
  border: 1px solid var(--doc-search-shortcut-border);
  border-radius: 3px;
}

.vd-doc-search-footer-item {
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

/* ============================================
   Category Icons
   ============================================ */

.vd-doc-search-result[data-category="getting-started"] .vd-doc-search-result-icon {
  background-color: var(--color-success-alpha-10, rgba(64, 192, 87, 0.1));
  color: var(--color-success);
}

.vd-doc-search-result[data-category="core"] .vd-doc-search-result-icon {
  background-color: var(--color-info-alpha-10, rgba(34, 139, 230, 0.1));
  color: var(--color-info);
}

.vd-doc-search-result[data-category="components"] .vd-doc-search-result-icon {
  background-color: var(--color-primary-alpha-10, rgba(34, 184, 207, 0.1));
  color: var(--color-primary);
}

.vd-doc-search-result[data-category="interactive"] .vd-doc-search-result-icon {
  background-color: var(--color-warning-alpha-10, rgba(250, 176, 5, 0.1));
  color: var(--color-warning);
}

.vd-doc-search-result[data-category="data-display"] .vd-doc-search-result-icon {
  background-color: var(--color-secondary-alpha-10, rgba(32, 201, 151, 0.1));
  color: var(--color-secondary);
}

.vd-doc-search-result[data-category="feedback"] .vd-doc-search-result-icon {
  background-color: var(--color-error-alpha-10, rgba(250, 82, 82, 0.1));
  color: var(--color-error);
}

/* ============================================
   Responsive Styles
   ============================================ */

@media (max-width: 991px) {
  .vd-doc-search {
    margin-bottom: 1rem;
  }
  
  .vd-doc-search-results {
    position: fixed;
    left: 1rem;
    right: 1rem;
    top: auto;
    max-height: 60vh;
  }
  
  .vd-doc-search-shortcut {
    display: none;
  }
  
  input.vd-doc-search-input {
    padding-right: var(--doc-search-input-padding-x);
    min-height: 44px;
  }
  
  .vd-doc-search-result {
    padding: 1rem;
  }
}

/* ============================================
   Animations
   ============================================ */

.vd-doc-search-results {
  animation: doc-search-fade-in 0.15s ease;
}

@keyframes doc-search-fade-in {
  from {
    opacity: 0;
    transform: translateY(-0.5rem);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .vd-doc-search-results {
    animation: none;
  }
  
  .vd-doc-search-loading-spinner {
    animation-duration: 1.5s;
  }
}
